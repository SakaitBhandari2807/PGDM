# SPARKIFY ETL PIPELINE

## About Project

The project is about creating a ETL pipelines for the sparkify data that is generated by their users and stored in log files on their servers. This data will be used by the analytics team at sparkify to better their product and analyse how the users are using their application and how they can improve the user experience.

## PREREQUISITE
1. ***Redshift Cluster up and running***
2. ***sparkify database in the redshift cluster***
3. ***INSTALL PSYCOPG2 PACKAGE***
4. ***INSTALL PANDAS***

## How to run the ETL Pipelines.

1. First we need to create the required tables to get started.This step can be achieved by running below command.
   
   ***python create_tables.py***
2. Next step is to load the data into the respective tables by reading the log files and song files from s3 bucket. 
   
   ***python etl.py***
3. Test the tables loaded in the redshift.



## Little Description about the python files

1. ***create_tables.py*** : This files contains the code that will get us started for the data load into the tables.This code helps to setup the tables needed for the data load.

2. ***etl.py*** : This files loads the data from s3 buckets into the staging tables in redshift and then into the final tables (Fact and dimensions).

3. ***sql_queries.py*** : This file contains the sql queries required for the project data load, table creation.


## DATABASE SCHEMA

### SONGS

Column|data type|constraints|key
---| ---|--- |---
song_id| varchar(20) |PRIMARY KEY NOT NULL | DISTKEY
title|text|NOT NULL
artist_id|varchar(20)|NOT NULL
year|int|NOT NULL
duration|real|NOT NULL

### ARTISTS

Column|data type|constraints|key
---| ---|--- | ---
artist_id|varchar(25)|PRIMARY KEY NOT NULL | DISTKEY
artist_name|varchar(300)|NOT NULL
artist_location|varchar(400)|
artist_latitude|real|
artist_longitude|real|


## USERS
Column|data type|constraints|key
---|---|---|---
user_id|smallint|PRIMARY KEY NOT NULL | DISTKEY
first_name|varchar(80)|NOT NULL
last_name|varchar(70)|NOT NULL
gender|char(1)| NOT NULL
level|char(4)|NOT NULL


## TIME
Column|data type|constraints|key
---|---|---|---
start_time|timestamp|PRIMARY KEY NOT NULL | DISTKEY
hour|int|NOT NULL
day|int|NOT NULL
week|int|NOT NULL
month|int|NOT NULL
year|int|NOT NULL
weekday|int|NOT NULL

## SONGPLAYS

Column|data type|constraints
---|---|---
songplay_id|int IDENTITY(1,1)|PRIMARY KEY
start_time|timestamp|NOT NULL
user_id|smallint|NOT NULL
level|char(4)|NOT NULL
song_id|varchar(25)|NOT NULL
artist_id|varchar(25)|NOT NULL
session_id|smallint|NOT NULL
location|TEXT|NOT NULL
user_agent|TEXT|NOT NULL
