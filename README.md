# SPARKIFY ETL PIPELINE

## About Project

The project is about creating a ETL pipelines for the sparkify data that is generated by their users and stored in log files on their servers. This data will be used by the analytics team at sparkify to better their product and analyse how the users are using their application and how they can improve the user experience.

## PREREQUISITE
1. ***Install POSTGRES DB***
2. ***create new user student and database***
3. ***INSTALL PSYCOPG2 PACKAGE***
4. ***INSTALL PANDAS***

## How to run the ETL Pipelines.

1. First we need to create the required database and tables to get started.This step can be achieved by running below command.
   
   ***python create_tables.py***
2. Next step is to load the data into the respective tables by reading the log files and song files. 
   
   ***python etl.py***
3. Test the tables loaded using the file test.ipynb. run the commands one by one present in the file.


## Little Description about the python files

1. ***create_tables.py*** : This files contains the code that will get us started for the data load into the tables.This code helps to setup the tables and database needed for the data load.

2. ***etl.py*** : This files reads the log files from the data folders and then parse it and loads the same into the database tables.

3. ***sql_queries.py*** : This file contains the sql queries required for the project data load, table creation.

## Some useful commands for psql cli
1. sudo -u postgres psql
2. For switching database : ***\c dbname***
3. For listing all users : ***\du***
4. For listing all databases : ***\l***
5. For listing all tables in a database : ***\dt+***
6. For listing all tables schema : ***\d+***

## DATABASE SCHEMA

### SONG

Column|data type|constraints 
---| ---|---
song_id| varchar(20) |PRIMARY KEY NOT NULL
title|varchar(80)|NOT NULL
artist_id|varchar(20)|NOT NULL
year|int|
duration|numeric(5,2)|NOT NULL

### ARTIST

Column|data type|constraints 
---| ---|---
artist_id|varchar(25)|PRIMARY KEY NOT NULL
artist_name|varchar(100)|NOT NULL
artist_location|varchar(35)|NOT NULL
artist_latitude|real|NOT NULL
artist_longitude|real|NOT NULL


## USERS
Column|data type|constraints
---|---|---
user_id|int|PRIMARY KEY NOT NULL
first_name|varchar(80)|NOT NULL
last_name|varchar(70)|NOT NULL
gender|char(1)| NOT NULL
level|char(4)|NOT NULL


## TIME
Column|data type|constraints
---|---|---
start_time|varchar(25)|PRIMARY KEY NOT NULL
hour|int|NOT NULL
day|int|NOT NULL
week|int|NOT NULL
month|int|NOT NULL
year|int|NOT NULL
weekday|int|NOT NULL

## SONGPLAYS

Column|data type|constraints
---|---|---
songplay_id|SERIAL|PRIMARY KEY
start_time|varchar(25)|NOT NULL
user_id|int|NOT NULL
level|char(4)|NOT NULL
song_id|varchar(25)|
artist_id|varchar(25)|
session_id|int|NOT NULL
location|TEXT|NOT NULL
user_agent|TEXT|NOT NULL
